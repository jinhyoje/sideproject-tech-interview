# [database]파티셔닝과 샤딩에 대해서 설명해 주세요.

- 왜 공부하나요??
    - **데이터베이스 볼륨이 커질 수록** 데이터베이스 탐색, 추가 등의 성능이 감소. 이에 대한 해결책으로 데이터베이스를 분할하여 관리하는 것
- **파티셔닝**
    - 매우 큰 테이블 여러 작은 테이블로 분할 작업 → 쿼리 성능 개선
    - 파티셔닝 후 데이터는 물리적으로 분할하지만 사용자는 마치 하나의 테이블에 접근하는 것처럼 관리할 수 있음
    - 참고로 MySQL 단에서 자체적으로 지원
    - MySQL 파티셔닝 종류
        - ****List Partitioning → 데이터를 종류별로 분할(ex → region)****
        - ****Range Partitioning → 특정 범위 기준 분할(ex → 1~2월 / 3~4월 / …)****
        - ****Hash Partitioning → 해시 함수를 사용하여 데이터 분할 / 참고 : 여러 컬럼으로 해싱하는 것은 권장하지 않음****
        - ****Composite Partitioning → 2가지 이상의 파티셔닝 방식 사용****
- **샤딩**
    - 동일한 스키마의 여러 데이터베이스 서버들에 데이터를 작은 단위로 나눠 분산 저장하는 기법(서로 다른 컴퓨터에 저장)
        - 데이터베이스 스키마란?
            - **Database 전체 또는 일부의 논리적인 구조 표현한 것**
    - shard : 샤딩의 작은 단위
    - 파티셔닝과의 차이점
        - 파티셔닝 → 모든 데이터 똑같은 컴퓨터에 저장
        - 샤딩 → 여러 데이터를 서로 다른 컴퓨터에 분산(수평확장) → 쿼리 성능 향상 / 부하 분산
    - 물리적 분산이기 때문에 데이터베이스일 때 나누는 것이 아닌 애플리케이션 레벨에서 구현
        - 다만, 샤딩을 플랫폼 차원에서 제공하는 시도가 많다고 한다.
    - 주의점
        - 물리적 분리이기에 데이터 조인이 어려움.
        - 한 컴퓨터에 데이터가 몰리면 Hotspot이 되어 성능 저하
            - Hotspot이란?
                - Hot + spot 으로 강하게 몰린 이라는 뜻
        - 따라서 데이터를 여러 샤드로 고르게 분배하는 것이 중요
    - 샤딩 종류
        - Hash Sharding → database id를 Hashing 하여 결정
            - 총 데이터베이스 수가 정해져있을 때 유용
            - 데이터베이스 수에 변동이 있을 경우 해시 함수도 변경해야하므로 데이터 재정렬이 필요(왜 해시 함수도 변경해야하는지 이해 안 감)
        - Range Sharding → PK값을 범위로 지정하여 샤드를 지정하는 방식
            - Hash Sharding에 비해 데이터베이스 증설 작업에 큰 리소스가 소유되지 않음
            - 그래서 급증하는 성격의 데이터베이스는 Range Sharding가 사용성이 더 좋음
            - 특이 케이스로 특정 데이터베이스에만 부하가 몰릴 수 있음
                - 페이스북 Range Sharding → 대부분이 최근 작성 게시물에 발생
                - 이런 경우 몰리는 DB는 재샤딩 / 트래픽이 저조한 DB는 통합 작업이 필요
